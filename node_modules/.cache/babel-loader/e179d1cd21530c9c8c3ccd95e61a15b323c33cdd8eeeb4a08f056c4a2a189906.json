{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { jwtDecode } from \"jwt-decode\";\nimport dayjs from \"dayjs\";\nimport { useContext } from \"react\";\nimport AuthContext from \"../context/AuthContext\";\nconst baseURL = \"https://timesculpt.pythonanywhere.com/api/\";\nconst useAxios = () => {\n  _s();\n  const {\n    authTokens,\n    setUser,\n    setAuthTokens\n  } = useContext(AuthContext);\n  const axiosInstance = axios.create({\n    baseURL,\n    headers: {\n      Authorization: `Bearer ${authTokens === null || authTokens === void 0 ? void 0 : authTokens.access}`\n    }\n  });\n  axiosInstance.interceptors.request.use(async req => {\n    const user = jwtDecode(authTokens.access);\n    const isExpired = dayjs.unix(user.exp).diff(dayjs()) < 1;\n    if (!isExpired) return req;\n    const response = await axios.post(`${baseURL}token/refresh/`, {\n      refresh: authTokens.refresh\n    });\n    localStorage.setItem(\"authTokens\", JSON.stringify(response.data));\n    setAuthTokens(response.data);\n    setUser(jwtDecode(response.data.access));\n    req.headers.Authorization = `Bearer ${jwtDecode(response.data.access)}`;\n    return req;\n  });\n  return axiosInstance;\n};\n_s(useAxios, \"7OXu5/VlXk7iW7f3Rph/dze6Gj4=\");\nexport default useAxios;","map":{"version":3,"names":["axios","jwtDecode","dayjs","useContext","AuthContext","baseURL","useAxios","_s","authTokens","setUser","setAuthTokens","axiosInstance","create","headers","Authorization","access","interceptors","request","use","req","user","isExpired","unix","exp","diff","response","post","refresh","localStorage","setItem","JSON","stringify","data"],"sources":["D:/REACT/react-django-jwt/frontend/src/utils/useAxios.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport dayjs from \"dayjs\";\r\nimport { useContext } from \"react\";\r\nimport AuthContext from \"../context/AuthContext\";\r\n\r\nconst baseURL = \"https://timesculpt.pythonanywhere.com/api/\";\r\n\r\nconst useAxios = () => {\r\n    const {authTokens, setUser, setAuthTokens } = useContext(AuthContext)\r\n\r\n    const axiosInstance = axios.create({\r\n        baseURL,\r\n        headers: {\r\n            Authorization : `Bearer ${authTokens?.access}`\r\n        }\r\n    })\r\n\r\n    axiosInstance.interceptors.request.use(\r\n        async req => {\r\n            const user = jwtDecode(authTokens.access)\r\n            const isExpired = dayjs.unix(user.exp).diff(dayjs()) < 1;\r\n\r\n            if (!isExpired) return req;\r\n\r\n            const response = await axios.post(`${baseURL}token/refresh/`, {\r\n                refresh: authTokens.refresh\r\n            });\r\n            localStorage.setItem(\"authTokens\", JSON.stringify(response.data))\r\n\r\n            setAuthTokens(response.data);\r\n            setUser(jwtDecode(response.data.access))\r\n\r\n            req.headers.Authorization = `Bearer ${jwtDecode(response.data.access)}`\r\n\r\n            return req;\r\n        }\r\n    )\r\n\r\n    return axiosInstance\r\n}\r\n\r\nexport default useAxios;"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,YAAY;AACtC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,UAAU,QAAQ,OAAO;AAClC,OAAOC,WAAW,MAAM,wBAAwB;AAEhD,MAAMC,OAAO,GAAG,4CAA4C;AAE5D,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACnB,MAAM;IAACC,UAAU;IAAEC,OAAO;IAAEC;EAAc,CAAC,GAAGP,UAAU,CAACC,WAAW,CAAC;EAErE,MAAMO,aAAa,GAAGX,KAAK,CAACY,MAAM,CAAC;IAC/BP,OAAO;IACPQ,OAAO,EAAE;MACLC,aAAa,EAAI,UAASN,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAEO,MAAO;IACjD;EACJ,CAAC,CAAC;EAEFJ,aAAa,CAACK,YAAY,CAACC,OAAO,CAACC,GAAG,CAClC,MAAMC,GAAG,IAAI;IACT,MAAMC,IAAI,GAAGnB,SAAS,CAACO,UAAU,CAACO,MAAM,CAAC;IACzC,MAAMM,SAAS,GAAGnB,KAAK,CAACoB,IAAI,CAACF,IAAI,CAACG,GAAG,CAAC,CAACC,IAAI,CAACtB,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC;IAExD,IAAI,CAACmB,SAAS,EAAE,OAAOF,GAAG;IAE1B,MAAMM,QAAQ,GAAG,MAAMzB,KAAK,CAAC0B,IAAI,CAAE,GAAErB,OAAQ,gBAAe,EAAE;MAC1DsB,OAAO,EAAEnB,UAAU,CAACmB;IACxB,CAAC,CAAC;IACFC,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEC,IAAI,CAACC,SAAS,CAACN,QAAQ,CAACO,IAAI,CAAC,CAAC;IAEjEtB,aAAa,CAACe,QAAQ,CAACO,IAAI,CAAC;IAC5BvB,OAAO,CAACR,SAAS,CAACwB,QAAQ,CAACO,IAAI,CAACjB,MAAM,CAAC,CAAC;IAExCI,GAAG,CAACN,OAAO,CAACC,aAAa,GAAI,UAASb,SAAS,CAACwB,QAAQ,CAACO,IAAI,CAACjB,MAAM,CAAE,EAAC;IAEvE,OAAOI,GAAG;EACd,CACJ,CAAC;EAED,OAAOR,aAAa;AACxB,CAAC;AAAAJ,EAAA,CAhCKD,QAAQ;AAkCd,eAAeA,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}