{"ast":null,"code":"import{createContext,useState,useEffect}from\"react\";import{jwtDecode}from\"jwt-decode\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";const swal=require('sweetalert2');const AuthContext=/*#__PURE__*/createContext();export default AuthContext;export const AuthProvider=_ref=>{let{children}=_ref;const[authTokens,setAuthTokens]=useState(()=>localStorage.getItem(\"authTokens\")?JSON.parse(localStorage.getItem(\"authTokens\")):null);const[user,setUser]=useState(localStorage.getItem(\"authTokens\")?jwtDecode(localStorage.getItem(\"authTokens\")):null);const[loading,setLoading]=useState(true);const navigate=useNavigate();const loginUser=async(email,password)=>{let url=\"https://timesculpt.pythonanywhere.com/api/token/\";const response=await fetch(url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email,password})});const data=await response.json();if(response.status===200){setAuthTokens(data);setUser(jwtDecode(data.access));localStorage.setItem(\"authTokens\",JSON.stringify(data));navigate(\"/\");swal.fire({title:\"Login Success\",icon:\"success\",toast:true,timer:6000,position:'top-right',timerProgressBar:true,showConfirmButton:false});}else{console.log(response.status);console.log(\"An Error Occured\");swal.fire({title:\"Email - Password does not exist\",icon:\"error\",toast:true,timer:6000,position:'top-right',timerProgressBar:true,showConfirmButton:false});}};const registerUser=async(full_name,email,username,password,password2)=>{let url=\"https://timesculpt.pythonanywhere.com/api/register/\";const response=await fetch(url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({full_name,email,username,password,password2})});const data=await response.json();if(response.status==201){navigate('/login');swal.fire({title:\"Registration Success\",icon:\"success\",toast:true,timer:6000,position:'top-right',timerProgressBar:true,showConfirmButton:false});}else{console.log(response.status);console.log(\"An Error Occured\");console.log(data);swal.fire({title:\"There was a server error\",icon:\"error\",toast:true,timer:6000,position:'top-right',timerProgressBar:true,showConfirmButton:false});}};const logoutUser=()=>{setAuthTokens(null);setUser(null);localStorage.removeItem(\"authTokens\");navigate('/login');swal.fire({title:\"You have been logged out\",icon:\"success\",toast:true,timer:6000,position:'top-right',timerProgressBar:true,showConfirmButton:false});};const contextData={user,setUser,authTokens,setAuthTokens,registerUser,loginUser,logoutUser};useEffect(()=>{if(authTokens){setUser(jwtDecode(authTokens.access));}setLoading(false);},[authTokens,loading]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:contextData,children:loading?null:children});};","map":{"version":3,"names":["createContext","useState","useEffect","jwtDecode","useNavigate","jsx","_jsx","swal","require","AuthContext","AuthProvider","_ref","children","authTokens","setAuthTokens","localStorage","getItem","JSON","parse","user","setUser","loading","setLoading","navigate","loginUser","email","password","url","response","fetch","method","headers","body","stringify","data","json","status","access","setItem","fire","title","icon","toast","timer","position","timerProgressBar","showConfirmButton","console","log","registerUser","full_name","username","password2","logoutUser","removeItem","contextData","Provider","value"],"sources":["D:/REACT/react-django-jwt/frontend/src/context/AuthContext.js"],"sourcesContent":["import { createContext, useState, useEffect } from \"react\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst swal = require('sweetalert2')\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport default AuthContext\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [authTokens, setAuthTokens] = useState(() => \r\n        localStorage.getItem(\"authTokens\") ? \r\n        JSON.parse(localStorage.getItem(\"authTokens\"))\r\n        : null\r\n    );\r\n\r\n    const [user, setUser] = useState(\r\n        localStorage.getItem(\"authTokens\") ? \r\n        jwtDecode(localStorage.getItem(\"authTokens\"))\r\n        : null\r\n    )\r\n\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    const navigate = useNavigate()\r\n\r\n    const loginUser = async (email, password) => {\r\n        let url = \"https://timesculpt.pythonanywhere.com/api/token/\"\r\n        const response = await fetch(url,{\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({email, password})\r\n        })\r\n        const data = await response.json()\r\n\r\n        if (response.status === 200){\r\n            setAuthTokens(data)\r\n            setUser(jwtDecode(data.access))\r\n            localStorage.setItem(\"authTokens\", JSON.stringify(data));\r\n            navigate(\"/\")\r\n            swal.fire({\r\n                title: \"Login Success\",\r\n                icon: \"success\",\r\n                toast: true,\r\n                timer: 6000,\r\n                position: 'top-right',\r\n                timerProgressBar: true,\r\n                showConfirmButton: false\r\n            })\r\n        } else {\r\n            console.log(response.status)\r\n            console.log(\"An Error Occured\")\r\n            swal.fire({\r\n                title: \"Email - Password does not exist\",\r\n                icon: \"error\",\r\n                toast: true,\r\n                timer: 6000,\r\n                position: 'top-right',\r\n                timerProgressBar: true,\r\n                showConfirmButton: false\r\n            })\r\n        }\r\n    }\r\n\r\n    const registerUser = async (full_name, email, username, password, password2) => {\r\n        let url = \"https://timesculpt.pythonanywhere.com/api/register/\"\r\n        const response = await fetch(url,{\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({full_name,email, username, password, password2})\r\n        })\r\n        const data = await response.json()\r\n\r\n        if (response.status == 201){\r\n            navigate('/login')\r\n            swal.fire({\r\n                title: \"Registration Success\",\r\n                icon: \"success\",\r\n                toast: true,\r\n                timer: 6000,\r\n                position: 'top-right',\r\n                timerProgressBar: true,\r\n                showConfirmButton: false\r\n            })\r\n        } else {\r\n            console.log(response.status)\r\n            console.log(\"An Error Occured\")\r\n            console.log(data)\r\n            swal.fire({\r\n                title: \"There was a server error\",\r\n                icon: \"error\",\r\n                toast: true,\r\n                timer: 6000,\r\n                position: 'top-right',\r\n                timerProgressBar: true,\r\n                showConfirmButton: false\r\n            })\r\n        }\r\n    }\r\n\r\n    const logoutUser = () => {\r\n        setAuthTokens(null)\r\n        setUser(null)\r\n        localStorage.removeItem(\"authTokens\")\r\n        navigate('/login')\r\n        swal.fire({\r\n            title: \"You have been logged out\",\r\n            icon: \"success\",\r\n            toast: true,\r\n            timer: 6000,\r\n            position: 'top-right',\r\n            timerProgressBar: true,\r\n            showConfirmButton: false\r\n        })\r\n    }\r\n\r\n    const contextData = {\r\n        user,setUser,\r\n        authTokens, setAuthTokens,\r\n        registerUser, loginUser, logoutUser\r\n    }\r\n\r\n    useEffect(()=>{\r\n\r\n        if (authTokens) {\r\n            setUser(jwtDecode(authTokens.access))\r\n        }\r\n        setLoading(false)\r\n    }, [authTokens, loading])\r\n\r\n    return (\r\n        <AuthContext.Provider value={contextData}>\r\n            {loading ? null : children}\r\n        </AuthContext.Provider>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}